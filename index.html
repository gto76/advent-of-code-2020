<!DOCTYPE html>
<html class="ocks-org do-not-copy">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
  <title>Advent of Code 2020</title>
  <meta name="description" content="Solutions to the problems from Advent of Code 2020.">
  <link rel="icon" href="web/favicon.png">
  <link rel="stylesheet" href="web/default.min.css">
  <link href="https://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Advent of Code 2020 solutions">
  <meta name="twitter:description" content="Solutions to the problems from Advent of Code 2020.">
  <meta name="twitter:image" content="https://gto76.github.io/python-cheatsheet/web/image_social_3.png">
  <!-- <meta name="google-site-verification" content="w3rvuG0D1kUm_w20qsJecSEZh59Am8jK4eSPVU83e_M" /> -->
  <meta name="viewport" id="viewport-meta">
</head>

<style>
@import url(web/style.css);

@font-face {font-family: "Menlo Regular";
  src: url("web\\OnlineWebFonts_COM_cb7eb796ae7de7195a34c485cacebad1\\@font-face\\9f94dc20bb2a09c15241d3a880b7ad01.woff2") format("woff2"), /* chrome、firefox */
  url("web\\OnlineWebFonts_COM_cb7eb796ae7de7195a34c485cacebad1\\@font-face\\9f94dc20bb2a09c15241d3a880b7ad01.woff") format("woff");
}

.join,
.link,
.node rect {
  fill: none;
  stroke: #636363;
  stroke-width: 1.5px;
}

.link {
  stroke: #969696;
}

.node rect {
  fill: white;
}

.link path,
.node rect,
.node text,
.join {
  -webkit-transition: stroke-opacity 500ms linear, fill-opacity 500ms linear;
  -moz-transition: stroke-opacity 500ms linear, fill-opacity 500ms linear;
  -ms-transition: stroke-opacity 500ms linear, fill-opacity 500ms linear;
  -o-transition: stroke-opacity 500ms linear, fill-opacity 500ms linear;
  transition: stroke-opacity 500ms linear, fill-opacity 500ms linear;
}

.node .element rect {
  fill: #bdbdbd;
  stroke: none;
}

.node .null rect {
  fill: none;
  stroke: none;
}

.node .null text {
  fill: #636363;
}

.node .selection rect {
  stroke: #e6550d;
}

.node .data rect {
  stroke: #3182bd;
}

.node .datum rect {
  fill: #d9d9d9;
  stroke: none;
}

.node .code text {
  font-family: monospace;
}

.node .key rect {
  fill: #a1d99b;
  stroke: none;
}

.link .to-key,
.join {
  stroke: #a1d99b;
}

.join {
  stroke-dasharray: 2,2;
}

.link .to-null {
  stroke-dasharray: .5,3.5;
  stroke-linecap: round;
}

.link .from-data {
  stroke: #3182bd;
}

.play circle {
  fill: #fff;
  stroke: #000;
  stroke-width: 3px;
}

.play:hover path {
  fill: #f00;
}

.play.mousedown circle {
  fill: #f00;
}

.play.mousedown path {
  fill: #fff;
}

.play rect {
  fill: none;
  pointer-events: all;
  cursor: pointer;
}

code span {
  -webkit-transition: background 250ms linear;
  -moz-transition: background 250ms linear;
  -ms-transition: background 250ms linear;
  -o-transition: background 250ms linear;
  transition: background 250ms linear;
}

pre.prettyprint, code.prettyprint {
  background-color: #222;
  border-radius: 8px;
  font-size: 15px;
}

pre.prettyprint {
  width: 90%;
  margin: 0.5em;
  padding: 1em;
  white-space: pre-wrap;
}

#return-to-top {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: rgb(0, 0, 0);
  background: rgba(0, 0, 0, 0.2);
  width: 50px;
  height: 50px;
  display: block;
  text-decoration: none;
  -webkit-border-radius: 35px;
  -moz-border-radius: 35px;
  border-radius: 35px;
  display: none;
  -webkit-transition: all 0.3s linear;
  -moz-transition: all 0.3s ease;
  -ms-transition: all 0.3s ease;
  -o-transition: all 0.3s ease;
  transition: all 0.3s ease;
}

#return-to-top i {
  color: #fff;
  margin: 0;
  position: relative;
  left: 16px;
  top: 13px;
  font-size: 19px;
  -webkit-transition: all 0.3s ease;
  -moz-transition: all 0.3s ease;
  -ms-transition: all 0.3s ease;
  -o-transition: all 0.3s ease;
  transition: all 0.3s ease;
}

#return-to-top:hover {
  background: rgba(0, 0, 0, 0.35);
}

#return-to-top:hover i {
   color: #f0f0f0;
}

@media print {
  .pagebreak { 
    page-break-before: always; 
  } 
  div {
    page-break-inside: avoid;
  }
  pre {
    page-break-inside: avoid;
  }
}

.modebar{
  display: none !important;
}
</style>

<body>
  <header>
    <aside>December 12, 2020</aside>
    <a href="https://gto76.github.io" rel="author">Jure Šorn</a>
  </header>

  <a href="javascript:" id="return-to-top"><i class="icon-chevron-up"></i></a>
   <div><h1 id="adventofcode2020">Advent of Code 2020</h1><p class="banner"><sup><a href="https://adventofcode.com/2020">Go to the site</a>, <a href="https://raw.githubusercontent.com/gto76/advent-of-code-2020/master/advent_2020.py">Download Python script</a> or <a href="https://github.com/gto76/advent-of-code-2020">Fork me on GitHub</a>.</sup></p><p class="banner"><img src="web/image_888.png" alt="Advent of Code"></p><div><h2 id="day1entries"><a href="#day1entries" name="day1entries">#</a>Day 1: Entries</h2><pre><code class="text language-text">1721
979
366
299
675
1456
</code></pre></div></div>




<div><h3 id="findthetwoentriesthatsumto2020whatdoyougetifyoumultiplythemtogether">Find the two entries that sum to 2020; what do you get if you multiply them together?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_1_a</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''514579'''</span>
    <span class="hljs-keyword">import</span> itertools
    numbers = [int(line) <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines]
    <span class="hljs-keyword">for</span> l, r <span class="hljs-keyword">in</span> itertools.combinations(numbers, <span class="hljs-number">2</span>):
        <span class="hljs-keyword">if</span> l + r == <span class="hljs-number">2020</span>:
            <span class="hljs-keyword">return</span> l * r
</code></pre></div>

<div><h3 id="inyourexpensereportwhatistheproductofthethreeentriesthatsumto2020">In your expense report, what is the product of the three entries that sum to 2020?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_1_b</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''241861950'''</span>
    <span class="hljs-keyword">import</span> itertools
    numbers = [int(line) <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines]
    <span class="hljs-keyword">for</span> a, b, c <span class="hljs-keyword">in</span> itertools.combinations(numbers, <span class="hljs-number">3</span>):
        <span class="hljs-keyword">if</span> a + b + c == <span class="hljs-number">2020</span>:
            <span class="hljs-keyword">return</span> a * b * c
</code></pre></div>

<div><h2 id="day2passwords"><a href="#day2passwords" name="day2passwords">#</a>Day 2: Passwords</h2><pre><code class="text language-text">1-3 a: abcde
1-3 b: cdefg
2-9 c: ccccccccc
</code></pre></div>

<div><h3 id="howmanypasswordsarevalidaccordingtotheirpolicies">How many passwords are valid according to their policies?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_2_a</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''2'''</span>
    <span class="hljs-keyword">import</span> re
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_valid</span><span class="hljs-params">(line)</span>:</span>
        min_, max_, letter, password = re.match(<span class="hljs-string">'^(\d+)-(\d+) (\w): (\w+)$'</span>, line).groups()
        <span class="hljs-keyword">return</span> int(min_) &lt;= password.count(letter) &lt;= int(max_)
    <span class="hljs-keyword">return</span> sum(is_valid(line) <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines)
</code></pre></div>

<div><h3 id="howmanypasswordsarevalidaccordingtothenewinterpretationofthepolicies">How many passwords are valid according to the new interpretation of the policies?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_2_b</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''1'''</span>
    <span class="hljs-keyword">import</span> re
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_valid</span><span class="hljs-params">(line)</span>:</span>
        i_1, i_2, letter, password = re.match(<span class="hljs-string">'^(\d+)-(\d+) (\w): (\w+)$'</span>, line).groups()
        <span class="hljs-keyword">return</span> (password[int(i_1)<span class="hljs-number">-1</span>] == letter) + (password[int(i_2)<span class="hljs-number">-1</span>] == letter) == <span class="hljs-number">1</span>
    <span class="hljs-keyword">return</span> sum(is_valid(line) <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines)
</code></pre></div>

<div><h2 id="day3trees"><a href="#day3trees" name="day3trees">#</a>Day 3: Trees</h2><pre><code class="text language-text">..##.......
#...#...#..
.#....#..#.
..#.#...#.#
.#...##..#.
..#.##.....
.#.#.#....#
.#........#
#.##...#...
#...##....#
.#..#...#.#
</code></pre></div>

<div><h3 id="startingatthetopleftcornerofyourmapandfollowingaslopeofright3anddown1howmanytreeswouldyouencounter">Starting at the top-left corner of your map and following a slope of right 3 and down 1, how many trees would you encounter?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_3_a</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''7'''</span>
    <span class="hljs-keyword">import</span> collections
    P = collections.namedtuple(<span class="hljs-string">'P'</span>, <span class="hljs-string">'x y'</span>)
    positions = (P(x=y*<span class="hljs-number">3</span>, y=y) <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> range(len(lines)))
    is_tree = <span class="hljs-keyword">lambda</span> p: lines[p.y][p.x % len(lines[<span class="hljs-number">0</span>])] == <span class="hljs-string">'#'</span>
    <span class="hljs-keyword">return</span> sum(is_tree(p) <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> positions)
</code></pre></div>

<div><h3 id="whatdoyougetifyoumultiplytogetherthenumberoftreesencounteredoneachofthelistedslopes">What do you get if you multiply together the number of trees encountered on each of the listed slopes?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_3_b</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''336'''</span>
    <span class="hljs-keyword">import</span> collections, functools, itertools, operator
    P = collections.namedtuple(<span class="hljs-string">'P'</span>, <span class="hljs-string">'x y'</span>)
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_positions</span><span class="hljs-params">(slope)</span>:</span>
        x_generator = itertools.count(start=<span class="hljs-number">0</span>, step=slope.x)
        <span class="hljs-keyword">return</span> (P(next(x_generator), y) <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, len(lines), slope.y))
    is_tree = <span class="hljs-keyword">lambda</span> p: lines[p.y][p.x % len(lines[<span class="hljs-number">0</span>])] == <span class="hljs-string">'#'</span>
    count_trees = <span class="hljs-keyword">lambda</span> slope: sum(is_tree(p) <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> get_positions(slope))
    slopes = [P(x=<span class="hljs-number">1</span>, y=<span class="hljs-number">1</span>), P(x=<span class="hljs-number">3</span>, y=<span class="hljs-number">1</span>), P(x=<span class="hljs-number">5</span>, y=<span class="hljs-number">1</span>), P(x=<span class="hljs-number">7</span>, y=<span class="hljs-number">1</span>), P(x=<span class="hljs-number">1</span>, y=<span class="hljs-number">2</span>)]
    <span class="hljs-keyword">return</span> functools.reduce(operator.mul, (count_trees(slope) <span class="hljs-keyword">for</span> slope <span class="hljs-keyword">in</span> slopes))
</code></pre></div>

<div><h2 id="day4passports"><a href="#day4passports" name="day4passports">#</a>Day 4: Passports</h2><pre><code class="text language-text">ecl:gry pid:860033327 eyr:2020 hcl:#fffffd
byr:1937 iyr:2017 cid:147 hgt:183cm

iyr:2013 ecl:amb cid:350 eyr:2023 pid:028048884
hcl:#cfa07d byr:1929

hcl:#ae17e1 iyr:2013
eyr:2024
ecl:brn pid:760753108 byr:1931
hgt:179cm

hcl:#cfa07d eyr:2025 pid:166559648
iyr:2011 ecl:brn hgt:59in
</code></pre></div>

<div><h3 id="inyourbatchfilehowmanypassportsarevalid">In your batch file, how many passports are valid?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_4_a</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''2'''</span>
    passports = <span class="hljs-string">' '</span>.join(lines).split(<span class="hljs-string">'  '</span>)
    get_keys = <span class="hljs-keyword">lambda</span> passport: {item.split(<span class="hljs-string">':'</span>)[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> passport.split()}
    is_valid = <span class="hljs-keyword">lambda</span> passport: len(get_keys(passport) - {<span class="hljs-string">'cid'</span>}) == <span class="hljs-number">7</span>
    <span class="hljs-keyword">return</span> sum(is_valid(p) <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> passports)
</code></pre></div>

<div><h3 id="inyourbatchfilehowmanypassportsarevalid-1">In your batch file, how many passports are valid?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_4_b</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''2'''</span>
    <span class="hljs-keyword">import</span> re

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_passport_valid</span><span class="hljs-params">(passport)</span>:</span>
        <span class="hljs-keyword">return</span> sum(is_field_valid(*item.split(<span class="hljs-string">':'</span>)) <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> passport.split()) == <span class="hljs-number">7</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_field_valid</span><span class="hljs-params">(key, value)</span>:</span>
        RULES = dict(
            byr=<span class="hljs-keyword">lambda</span> v: <span class="hljs-number">1920</span> &lt;= int(v) &lt;= <span class="hljs-number">2002</span>,
            iyr=<span class="hljs-keyword">lambda</span> v: <span class="hljs-number">2010</span> &lt;= int(v) &lt;=  <span class="hljs-number">2020</span>,
            eyr=<span class="hljs-keyword">lambda</span> v: <span class="hljs-number">2020</span> &lt;= int(v) &lt;=  <span class="hljs-number">2030</span>,
            hgt=<span class="hljs-keyword">lambda</span> v: <span class="hljs-number">150</span> &lt;= int(v[:<span class="hljs-number">-2</span>]) &lt;= <span class="hljs-number">193</span> <span class="hljs-keyword">if</span> <span class="hljs-string">'cm'</span> <span class="hljs-keyword">in</span> v <span class="hljs-keyword">else</span> <span class="hljs-number">59</span> &lt;= int(v[:<span class="hljs-number">-2</span>]) &lt;= <span class="hljs-number">76</span>,
            hcl=<span class="hljs-keyword">lambda</span> v: re.match(<span class="hljs-string">'#[0-9a-f]{6}$'</span>, v) != <span class="hljs-keyword">None</span>,
            ecl=<span class="hljs-keyword">lambda</span> v: v <span class="hljs-keyword">in</span> <span class="hljs-string">'amb blu brn gry grn hzl oth'</span>.split(),
            pid=<span class="hljs-keyword">lambda</span> v: re.match(<span class="hljs-string">'\d{9}$'</span>, v) != <span class="hljs-keyword">None</span>
        )
        <span class="hljs-keyword">try</span>:
            <span class="hljs-keyword">return</span> RULES[key](value)
        <span class="hljs-keyword">except</span> Exception:
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">False</span>

    passports = <span class="hljs-string">' '</span>.join(lines).split(<span class="hljs-string">'  '</span>)
    <span class="hljs-keyword">return</span> sum(is_passport_valid(p) <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> passports)
</code></pre></div>

<div><h2 id="day5seatids"><a href="#day5seatids" name="day5seatids">#</a>Day 5: Seat IDs</h2><pre><code class="text language-text">BBFFBBFLLR
BBFFBBFLRL
BBFFBBFRLL
</code></pre></div>

<div><h3 id="whatisthehighestseatidonaboardingpass">What is the highest seat ID on a boarding pass?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_5_a</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''820'''</span>
    get_bin = <span class="hljs-keyword">lambda</span> code: <span class="hljs-string">''</span>.join(<span class="hljs-string">'0'</span> <span class="hljs-keyword">if</span> ch <span class="hljs-keyword">in</span> <span class="hljs-string">'FL'</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'1'</span> <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> code)
    get_id  = <span class="hljs-keyword">lambda</span> code: int(get_bin(code), <span class="hljs-number">2</span>)
    <span class="hljs-keyword">return</span> max(get_id(code) <span class="hljs-keyword">for</span> code <span class="hljs-keyword">in</span> lines)
</code></pre></div>

<div><h3 id="whatistheidofyourseat">What is the ID of your seat?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_5_b</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''819'''</span>
    get_bin   = <span class="hljs-keyword">lambda</span> code: <span class="hljs-string">''</span>.join(<span class="hljs-string">'0'</span> <span class="hljs-keyword">if</span> ch <span class="hljs-keyword">in</span> <span class="hljs-string">'FL'</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'1'</span> <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> code)
    get_id    = <span class="hljs-keyword">lambda</span> code: int(get_bin(code), <span class="hljs-number">2</span>)
    taken_ids = {get_id(code) <span class="hljs-keyword">for</span> code <span class="hljs-keyword">in</span> lines}
    all_ids   = range(min(taken_ids), max(taken_ids)+<span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> (set(all_ids) - taken_ids).pop()
</code></pre></div>

<div><h2 id="day6answers"><a href="#day6answers" name="day6answers">#</a>Day 6: Answers</h2><pre><code class="text language-text">abc

a
b
c

ab
ac

a
a
a
a

b
</code></pre></div>

<div><h3 id="foreachgroupcountthenumberofquestionstowhichanyoneansweredyeswhatisthesumofthosecounts">For each group, count the number of questions to which anyone answered "yes". What is the sum of those counts?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_6_a</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''11'''</span>
    groups = (set(group) - {<span class="hljs-string">' '</span>} <span class="hljs-keyword">for</span> group <span class="hljs-keyword">in</span> <span class="hljs-string">' '</span>.join(lines).split(<span class="hljs-string">'  '</span>))
    <span class="hljs-keyword">return</span> sum(len(group) <span class="hljs-keyword">for</span> group <span class="hljs-keyword">in</span> groups)
</code></pre></div>

<div><h3 id="foreachgroupcountthenumberofquestionstowhicheveryoneansweredyeswhatisthesumofthosecounts">For each group, count the number of questions to which everyone answered "yes". What is the sum of those counts?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_6_b</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''6'''</span>
    <span class="hljs-keyword">import</span> functools, operator
    groups             = <span class="hljs-string">' '</span>.join(lines).split(<span class="hljs-string">'  '</span>)
    split_group        = <span class="hljs-keyword">lambda</span> group: (set(a) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> group.split(<span class="hljs-string">' '</span>))
    get_common_answers = <span class="hljs-keyword">lambda</span> group: functools.reduce(operator.and_, split_group(group))
    <span class="hljs-keyword">return</span> sum(len(get_common_answers(group)) <span class="hljs-keyword">for</span> group <span class="hljs-keyword">in</span> groups)
</code></pre></div>

<div><h2 id="day7bags"><a href="#day7bags" name="day7bags">#</a>Day 7: Bags</h2><pre><code class="text language-text">light red bags contain 1 bright white bag, 2 muted yellow bags.
dark orange bags contain 3 bright white bags, 4 muted yellow bags.
bright white bags contain 1 shiny gold bag.
muted yellow bags contain 2 shiny gold bags, 9 faded blue bags.
shiny gold bags contain 1 dark olive bag, 2 vibrant plum bags.
dark olive bags contain 3 faded blue bags, 4 dotted black bags.
vibrant plum bags contain 5 faded blue bags, 6 dotted black bags.
faded blue bags contain no other bags.
dotted black bags contain no other bags.
</code></pre></div>

<div><h3 id="howmanybagcolorscaneventuallycontainatleastoneshinygoldbag">How many bag colors can eventually contain at least one shiny gold bag?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_7_a</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''4'''</span>
    <span class="hljs-keyword">import</span> re

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse_line</span><span class="hljs-params">(line)</span>:</span>
        container, contents = line.split(<span class="hljs-string">' bags contain '</span>)
        <span class="hljs-keyword">if</span> contents == <span class="hljs-string">'no other bags.'</span>:
            <span class="hljs-keyword">return</span> container, set()
        get_color = <span class="hljs-keyword">lambda</span> token: re.search(<span class="hljs-string">'\d+ (.*) .*$'</span>, token).group(<span class="hljs-number">1</span>) 
        <span class="hljs-keyword">return</span> container, {get_color(a) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> contents.split(<span class="hljs-string">','</span>)}

    bags = dict(parse_line(line) <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines)
    out = {k <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> bags.items() <span class="hljs-keyword">if</span> <span class="hljs-string">'shiny gold'</span> <span class="hljs-keyword">in</span> v}
    <span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
        new_colors = {k <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> bags.items() <span class="hljs-keyword">if</span> out &amp; v}
        <span class="hljs-keyword">if</span> new_colors &lt;= out:
            <span class="hljs-keyword">return</span> len(out)
        out |= new_colors
</code></pre></div>

<div><h3 id="howmanyindividualbagsarerequiredinsideyoursingleshinygoldbag">How many individual bags are required inside your single shiny gold bag?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_7_b</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''32'''</span>
    <span class="hljs-keyword">import</span> re

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse_line</span><span class="hljs-params">(line)</span>:</span>
        container, contents = line.split(<span class="hljs-string">' bags contain '</span>)
        <span class="hljs-keyword">if</span> contents == <span class="hljs-string">'no other bags.'</span>:
            <span class="hljs-keyword">return</span> container, set()
        get_number_and_color = <span class="hljs-keyword">lambda</span> token: re.search(<span class="hljs-string">'(\d+) (.*) .*$'</span>, token).groups()
        <span class="hljs-keyword">return</span> container, {get_number_and_color(a) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> contents.split(<span class="hljs-string">','</span>)}

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_n_bags</span><span class="hljs-params">(color)</span>:</span>
        contents = bags[color]
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> contents:
            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> + sum(int(n) * get_n_bags(color) <span class="hljs-keyword">for</span> n, color <span class="hljs-keyword">in</span> contents)

    bags = dict(parse_line(line) <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines)
    <span class="hljs-keyword">return</span> get_n_bags(<span class="hljs-string">'shiny gold'</span>) - <span class="hljs-number">1</span>
</code></pre></div>

<div><h2 id="day8program"><a href="#day8program" name="day8program">#</a>Day 8: Program</h2><pre><code class="text language-text">nop +0
acc +1
jmp +4
acc +3
jmp -3
acc -99
acc +1
jmp -4
acc +6
</code></pre></div>

<div><h3 id="runyourcopyofthebootcodeimmediatelybeforeanyinstructionisexecutedasecondtimewhatvalueisintheaccumulator">Run your copy of the boot code. Immediately before any instruction is executed a second time, what value is in the accumulator?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_8_a</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''5'''</span>
    OPERATIONS = dict(
        acc=<span class="hljs-keyword">lambda</span> pc, accumulator, argument: (pc+<span class="hljs-number">1</span>, accumulator+int(argument)),
        jmp=<span class="hljs-keyword">lambda</span> pc, accumulator, argument: (pc+int(argument), accumulator),
        nop=<span class="hljs-keyword">lambda</span> pc, accumulator, argument: (pc+<span class="hljs-number">1</span>, accumulator)
    )
    pc = <span class="hljs-number">0</span>
    accumulator = <span class="hljs-number">0</span>
    executed = set()
    <span class="hljs-keyword">while</span> pc <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> executed:
        executed.add(pc)
        operation, argument = lines[pc].split()
        pc, accumulator = OPERATIONS[operation](pc, accumulator, argument)
    <span class="hljs-keyword">return</span> accumulator
</code></pre></div>

<div><h3 id="fixtheprogramsothatitterminatesnormallybychangingexactlyonejmptonopornoptojmpwhatisthevalueoftheaccumulatoraftertheprogramterminates">Fix the program so that it terminates normally by changing exactly one jmp (to nop) or nop (to jmp). What is the value of the accumulator after the program terminates?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_8_b</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''8'''</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>
        <span class="hljs-keyword">for</span> program <span class="hljs-keyword">in</span> program_generator():
            result = run(program)
            <span class="hljs-keyword">if</span> result <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">None</span>:
                <span class="hljs-keyword">return</span> result

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">program_generator</span><span class="hljs-params">()</span>:</span>
        <span class="hljs-keyword">for</span> i, line <span class="hljs-keyword">in</span> enumerate(lines):
            <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">'acc'</span>):
                <span class="hljs-keyword">continue</span>
            line = line.replace(<span class="hljs-string">'jmp'</span>, <span class="hljs-string">'nop'</span>) <span class="hljs-keyword">if</span> <span class="hljs-string">'jmp'</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">else</span> line.replace(<span class="hljs-string">'nop'</span>, <span class="hljs-string">'jmp'</span>)
            <span class="hljs-keyword">yield</span> lines[:i] + [line] + lines[i+<span class="hljs-number">1</span>:]

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span><span class="hljs-params">(program)</span>:</span>
        OPERATIONS = dict(
            acc=<span class="hljs-keyword">lambda</span> pc, accumulator, argument: (pc+<span class="hljs-number">1</span>, accumulator+int(argument)),
            jmp=<span class="hljs-keyword">lambda</span> pc, accumulator, argument: (pc+int(argument), accumulator),
            nop=<span class="hljs-keyword">lambda</span> pc, accumulator, argument: (pc+<span class="hljs-number">1</span>, accumulator)
        )
        pc = <span class="hljs-number">0</span>
        accumulator = <span class="hljs-number">0</span>
        executed = set()
        <span class="hljs-keyword">while</span> pc <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> executed:
            executed.add(pc)
            operation, argument = program[pc].split()
            pc, accumulator = OPERATIONS[operation](pc, accumulator, argument)
            <span class="hljs-keyword">if</span> pc == len(program):
                <span class="hljs-keyword">return</span> accumulator
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">None</span>

    <span class="hljs-keyword">return</span> main()
</code></pre></div>

<div><h2 id="day9encryption"><a href="#day9encryption" name="day9encryption">#</a>Day 9: Encryption</h2><pre><code class="text language-text">20
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
21
22
23
24
25
45
65
</code></pre></div>

<div><h3 id="thefirststepofattackingtheweaknessinthexmasdataistofindthefirstnumberinthelistafterthepreamblewhichisnotthesumoftwoofthe25numbersbeforeitwhatisthefirstnumberthatdoesnothavethisproperty">The first step of attacking the weakness in the XMAS data is to find the first number in the list (after the preamble) which is not the sum of two of the 25 numbers before it. What is the first number that does not have this property?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_9_a</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''65'''</span>
    <span class="hljs-keyword">import</span> itertools

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_sum</span><span class="hljs-params">(candidate, numbers)</span>:</span>
        <span class="hljs-keyword">return</span> any(a + b == candidate <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> itertools.combinations(numbers, <span class="hljs-number">2</span>))

    numbers = [int(line) <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines]
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">25</span>, len(numbers)):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> is_sum(numbers[i], numbers[i<span class="hljs-number">-25</span>:i]):
            <span class="hljs-keyword">return</span> numbers[i]
</code></pre></div>

<div><h3 id="whatistheencryptionweaknessinyourxmasencryptedlistofnumbers">What is the encryption weakness in your XMAS-encrypted list of numbers?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_9_b</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''21'''</span>
    invalid_number = problem_9_a(lines)
    numbers = [int(line) <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines]
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(numbers)):
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(i+<span class="hljs-number">2</span>, len(numbers)):
            sum_ = sum(numbers[i:j])
            <span class="hljs-keyword">if</span> sum_ == invalid_number:
                <span class="hljs-keyword">return</span> min(numbers[i:j]) + max(numbers[i:j])
            <span class="hljs-keyword">elif</span> sum_ &gt; invalid_number:
                <span class="hljs-keyword">break</span>
</code></pre></div>

<div><h2 id="day10adapters"><a href="#day10adapters" name="day10adapters">#</a>Day 10: Adapters</h2><pre><code class="text language-text">28
33
18
42
31
14
46
20
48
47
24
23
49
45
19
38
39
11
1
32
25
35
8
17
7
9
4
2
34
10
3
</code></pre></div>

<div><h3 id="whatisthenumberof1joltdifferencesmultipliedbythenumberof3joltdifferences">What is the number of 1-jolt differences multiplied by the number of 3-jolt differences?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_10_a</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''220'''</span>
    numbers = [<span class="hljs-number">0</span>] + sorted(int(a) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> lines)
    deltas = [b-a <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> zip(numbers, numbers[<span class="hljs-number">1</span>:])]
    <span class="hljs-keyword">return</span> deltas.count(<span class="hljs-number">1</span>) * (deltas.count(<span class="hljs-number">3</span>)+<span class="hljs-number">1</span>)
</code></pre></div>

<div><h3 id="whatisthetotalnumberofdistinctwaysyoucanarrangetheadapterstoconnectthechargingoutlettoyourdevice">What is the total number of distinct ways you can arrange the adapters to connect the charging outlet to your device?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_10_b</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''19208'''</span>
    <span class="hljs-keyword">import</span> functools, operator <span class="hljs-keyword">as</span> op
    numbers = sorted(int(a) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> lines)
    numbers = [<span class="hljs-number">0</span>] + numbers + [numbers[<span class="hljs-number">-1</span>]+<span class="hljs-number">3</span>]
    deltas = [b-a <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> zip(numbers, numbers[<span class="hljs-number">1</span>:])]
    d = <span class="hljs-string">''</span>.join(str(a) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> deltas)
    dd = [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">13</span>, <span class="hljs-number">23</span>][len(a)<span class="hljs-number">-1</span>] <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> d.split(<span class="hljs-string">'3'</span>) <span class="hljs-keyword">if</span> a]
    <span class="hljs-keyword">return</span> functools.reduce(op.mul, dd)
</code></pre></div>

<div><h2 id="day11seats"><a href="#day11seats" name="day11seats">#</a>Day 11: Seats</h2><pre><code class="text language-text">L.LL.LL.LL
LLLLLLL.LL
L.L.L..L..
LLLL.LL.LL
L.LL.LL.LL
L.LLLLL.LL
..L.L.....
LLLLLLLLLL
L.LLLLLL.L
L.LLLLL.LL
</code></pre></div>

<div><h3 id="simulateyourseatingareabyapplyingtheseatingrulesrepeatedlyuntilnoseatschangestatehowmanyseatsendupoccupied">Simulate your seating area by applying the seating rules repeatedly until no seats change state. How many seats end up occupied?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_11_a</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''37'''</span>
    <span class="hljs-keyword">import</span> collections

    P = collections.namedtuple(<span class="hljs-string">'P'</span>, <span class="hljs-string">'x y'</span>)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>
        layout = {P(x, y): ch <span class="hljs-keyword">for</span> y, line <span class="hljs-keyword">in</span> enumerate(lines) <span class="hljs-keyword">for</span> x, ch <span class="hljs-keyword">in</span> enumerate(line)}
        <span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
            new_layout = step(layout)
            <span class="hljs-keyword">if</span> new_layout == layout:
                <span class="hljs-keyword">return</span> list(layout.values()).count(<span class="hljs-string">'#'</span>)
            layout = new_layout

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">step</span><span class="hljs-params">(layout)</span>:</span>
        out = dict(layout)
        <span class="hljs-keyword">for</span> p, ch <span class="hljs-keyword">in</span> layout.items():
            adjecent_chars = [layout.get(a) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> get_adjecent_positions(p)]
            <span class="hljs-keyword">if</span> ch == <span class="hljs-string">'L'</span> <span class="hljs-keyword">and</span> <span class="hljs-string">'#'</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> adjecent_chars:
                out[p] = <span class="hljs-string">'#'</span>
            <span class="hljs-keyword">elif</span> ch == <span class="hljs-string">'#'</span> <span class="hljs-keyword">and</span> adjecent_chars.count(<span class="hljs-string">'#'</span>) &gt;= <span class="hljs-number">4</span>:
                out[p] = <span class="hljs-string">'L'</span>
        <span class="hljs-keyword">return</span> out

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_adjecent_positions</span><span class="hljs-params">(p)</span>:</span>
        DELTAS = [P(<span class="hljs-number">-1</span>, <span class="hljs-number">-1</span>), P(<span class="hljs-number">0</span>, <span class="hljs-number">-1</span>), P(<span class="hljs-number">1</span>, <span class="hljs-number">-1</span>), P(<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>), P(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>), P(<span class="hljs-number">-1</span>, <span class="hljs-number">1</span>), P(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), P(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)]
        <span class="hljs-keyword">return</span> (P(p.x + dx, p.y + dy) <span class="hljs-keyword">for</span> dx, dy <span class="hljs-keyword">in</span> DELTAS)

    <span class="hljs-keyword">return</span> main()
</code></pre></div>

<div><h3 id="giventhenewvisibilitymethodandtherulechangeforoccupiedseatsbecomingemptyonceequilibriumisreachedhowmanyseatsendupoccupied">Given the new visibility method and the rule change for occupied seats becoming empty, once equilibrium is reached, how many seats end up occupied?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_11_b</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''26'''</span>
    <span class="hljs-keyword">import</span> collections
    P = collections.namedtuple(<span class="hljs-string">'P'</span>, <span class="hljs-string">'x y'</span>)

    layout = {P(x, y): ch <span class="hljs-keyword">for</span> y, line <span class="hljs-keyword">in</span> enumerate(lines) <span class="hljs-keyword">for</span> x, ch <span class="hljs-keyword">in</span> enumerate(line)}

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>
        <span class="hljs-keyword">nonlocal</span> layout
        <span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
            new_layout = {p: get_new_ch(p, ch) <span class="hljs-keyword">for</span> p, ch <span class="hljs-keyword">in</span> layout.items()}
            <span class="hljs-keyword">if</span> new_layout == layout:
                <span class="hljs-keyword">return</span> list(layout.values()).count(<span class="hljs-string">'#'</span>)
            layout = new_layout

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_new_ch</span><span class="hljs-params">(p, ch)</span>:</span>
        DIRECTIONS = [P(<span class="hljs-number">-1</span>, <span class="hljs-number">-1</span>), P(<span class="hljs-number">0</span>, <span class="hljs-number">-1</span>), P(<span class="hljs-number">1</span>, <span class="hljs-number">-1</span>), P(<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>), P(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>), P(<span class="hljs-number">-1</span>, <span class="hljs-number">1</span>), P(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>),
                      P(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)]
        visible_chairs = [get_visible_chair(p, direction) <span class="hljs-keyword">for</span> direction <span class="hljs-keyword">in</span> DIRECTIONS]
        <span class="hljs-keyword">if</span> ch == <span class="hljs-string">'L'</span> <span class="hljs-keyword">and</span> <span class="hljs-string">'#'</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> visible_chairs:
            <span class="hljs-keyword">return</span> <span class="hljs-string">'#'</span>
        <span class="hljs-keyword">elif</span> ch == <span class="hljs-string">'#'</span> <span class="hljs-keyword">and</span> visible_chairs.count(<span class="hljs-string">'#'</span>) &gt;= <span class="hljs-number">5</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">'L'</span>
        <span class="hljs-keyword">return</span> ch

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_visible_chair</span><span class="hljs-params">(p, direction)</span>:</span>
        <span class="hljs-keyword">while</span> p <span class="hljs-keyword">in</span> layout:
            p = P(p.x + direction.x, p.y + direction.y)
            <span class="hljs-keyword">if</span> p <span class="hljs-keyword">in</span> layout <span class="hljs-keyword">and</span> layout[p] <span class="hljs-keyword">in</span> <span class="hljs-string">'L#'</span>:
                <span class="hljs-keyword">return</span> layout[p]

    <span class="hljs-keyword">return</span> main()
</code></pre></div>

<div><h2 id="day12navigation"><a href="#day12navigation" name="day12navigation">#</a>Day 12: Navigation</h2><pre><code class="text language-text">F10
N3
F7
R90
F11
</code></pre></div>

<div><h3 id="figureoutwherethenavigationinstructionsleadwhatisthemanhattandistancebetweenthatlocationandtheshipsstartingposition">Figure out where the navigation instructions lead. What is the Manhattan distance between that location and the ship's starting position?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_12_a</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''25'''</span>
    <span class="hljs-keyword">import</span> collections, enum

    P = collections.namedtuple(<span class="hljs-string">'P'</span>, <span class="hljs-string">'x y'</span>)
    D = enum.Enum(<span class="hljs-string">'D'</span>, <span class="hljs-string">'n e s w'</span>)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>
        p, d = P(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), D.e
        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:
            p, d = step(p, d, line)
        <span class="hljs-keyword">return</span> abs(p.x) + abs(p.y)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">step</span><span class="hljs-params">(p, d, line)</span>:</span>
        DELTAS = {D.n: P(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), D.e: P(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>), D.s: P(<span class="hljs-number">0</span>, <span class="hljs-number">-1</span>), D.w: P(<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>)}
        ACTIONS = dict(
            N=<span class="hljs-keyword">lambda</span> p, d, arg: (P(p.x, p.y+arg), d),
            S=<span class="hljs-keyword">lambda</span> p, d, arg: (P(p.x, p.y-arg), d),
            E=<span class="hljs-keyword">lambda</span> p, d, arg: (P(p.x+arg, p.y), d),
            W=<span class="hljs-keyword">lambda</span> p, d, arg: (P(p.x-arg, p.y), d),
            L=<span class="hljs-keyword">lambda</span> p, d, arg: (p, turn(d, -arg)),
            R=<span class="hljs-keyword">lambda</span> p, d, arg: (p, turn(d, arg)),
            F=<span class="hljs-keyword">lambda</span> p, d, arg: (P(p.x + DELTAS[d].x*arg, p.y + DELTAS[d].y*arg), d)
        )
        action_id, arg = line[<span class="hljs-number">0</span>], int(line[<span class="hljs-number">1</span>:])
        <span class="hljs-keyword">return</span> ACTIONS[action_id](p, d, arg)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">turn</span><span class="hljs-params">(d, degrees)</span>:</span>
        directions = list(D)
        index = (directions.index(d) + degrees//<span class="hljs-number">90</span>) % len(directions)
        <span class="hljs-keyword">return</span> directions[index]

    <span class="hljs-keyword">return</span> main()
</code></pre></div>

<div><h3 id="figureoutwherethenavigationinstructionsactuallyleadwhatisthemanhattandistancebetweenthatlocationandtheshipsstartingposition">Figure out where the navigation instructions actually lead. What is the Manhattan distance between that location and the ship's starting position?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_12_b</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''286'''</span>
    <span class="hljs-keyword">import</span> collections

    P = collections.namedtuple(<span class="hljs-string">'P'</span>, <span class="hljs-string">'x y'</span>)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>
        p, waypoint = P(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), P(<span class="hljs-number">10</span>, <span class="hljs-number">1</span>)
        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:
            p, waypoint = step(p, waypoint, line)
        <span class="hljs-keyword">return</span> abs(p.x) + abs(p.y)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">step</span><span class="hljs-params">(p, waypoint, line)</span>:</span>
        ACTIONS = dict(
            N=<span class="hljs-keyword">lambda</span> p, waypoint, arg: (p, P(waypoint.x, waypoint.y+arg)),
            S=<span class="hljs-keyword">lambda</span> p, waypoint, arg: (p, P(waypoint.x, waypoint.y-arg)),
            E=<span class="hljs-keyword">lambda</span> p, waypoint, arg: (p, P(waypoint.x+arg, waypoint.y)),
            W=<span class="hljs-keyword">lambda</span> p, waypoint, arg: (p, P(waypoint.x-arg, waypoint.y)),
            L=<span class="hljs-keyword">lambda</span> p, waypoint, arg: (p, turn(waypoint, -arg)),
            R=<span class="hljs-keyword">lambda</span> p, waypoint, arg: (p, turn(waypoint, arg)),
            F=<span class="hljs-keyword">lambda</span> p, waypoint, arg: (P(p.x + waypoint.x*arg, p.y + waypoint.y*arg), 
                                        waypoint)
        )
        action_id, arg = line[<span class="hljs-number">0</span>], int(line[<span class="hljs-number">1</span>:])
        <span class="hljs-keyword">return</span> ACTIONS[action_id](p, waypoint, arg)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">turn</span><span class="hljs-params">(waypoint, degrees)</span>:</span>
        degrees += <span class="hljs-number">360</span> <span class="hljs-keyword">if</span> degrees &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>
        TURN = {<span class="hljs-number">90</span>:  P(x=waypoint.y,  y=-waypoint.x),
                <span class="hljs-number">180</span>: P(x=-waypoint.x, y=-waypoint.y), 
                <span class="hljs-number">270</span>: P(x=-waypoint.y, y=waypoint.x)}
        <span class="hljs-keyword">return</span> TURN[degrees]

    <span class="hljs-keyword">return</span> main()
</code></pre></div>

<div><h2 id="day13buses"><a href="#day13buses" name="day13buses">#</a>Day 13: Buses</h2><pre><code class="text language-text">939
7,13,x,x,59,x,31,19
</code></pre></div>

<div><h3 id="whatistheidoftheearliestbusyoucantaketotheairportmultipliedbythenumberofminutesyoullneedtowaitforthatbus">What is the ID of the earliest bus you can take to the airport multiplied by the number of minutes you'll need to wait for that bus?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_13_a</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''295'''</span>
    <span class="hljs-keyword">import</span> itertools
    stamp = int(lines[<span class="hljs-number">0</span>])
    ids = [int(a) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> lines[<span class="hljs-number">1</span>].split(<span class="hljs-string">','</span>) <span class="hljs-keyword">if</span> a != <span class="hljs-string">'x'</span>]
    get_departures = <span class="hljs-keyword">lambda</span> stamp, id_: range(<span class="hljs-number">0</span>, stamp+id_, id_)
    timetable = [get_departures(stamp, id_) <span class="hljs-keyword">for</span> id_ <span class="hljs-keyword">in</span> ids]
    departure = min(a <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> itertools.chain.from_iterable(timetable) <span class="hljs-keyword">if</span> a &gt;= stamp)
    id_ = [a <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> ids <span class="hljs-keyword">if</span> departure % a == <span class="hljs-number">0</span>][<span class="hljs-number">0</span>]
    <span class="hljs-keyword">return</span> id_ * (departure - stamp)
</code></pre></div>

<div><h3 id="whatistheearliesttimestampsuchthatallofthelistedbusidsdepartatoffsetsmatchingtheirpositionsinthelist">What is the earliest timestamp such that all of the listed bus IDs depart at offsets matching their positions in the list?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_13_b</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''1068781'''</span>
    buses = [(offset, int(id_)) <span class="hljs-keyword">for</span> offset, id_ <span class="hljs-keyword">in</span> enumerate(lines[<span class="hljs-number">1</span>].split(<span class="hljs-string">','</span>))
                <span class="hljs-keyword">if</span> id_ != <span class="hljs-string">'x'</span>]
    stamp = <span class="hljs-number">0</span>
    least_common_multiple = <span class="hljs-number">1</span>
    <span class="hljs-keyword">for</span> offset, id_ <span class="hljs-keyword">in</span> buses:
        <span class="hljs-keyword">while</span> (stamp + offset) % id_ != <span class="hljs-number">0</span>:
            stamp += least_common_multiple
        least_common_multiple *= id_
    <span class="hljs-keyword">return</span> stamp
</code></pre></div>

<div><h2 id="day14bitmasks"><a href="#day14bitmasks" name="day14bitmasks">#</a>Day 14: Bitmasks</h2><pre><code class="text language-text">mask = 000000000000000000000000000000X1001X
mem[42] = 100
mask = 00000000000000000000000000000000X0XX
mem[26] = 1
</code></pre></div>

<div><h3 id="executetheinitializationprogramwhatisthesumofallvaluesleftinmemoryafteritcompletes">Execute the initialization program. What is the sum of all values left in memory after it completes?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_14_a</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''51'''</span>
    <span class="hljs-keyword">import</span> re

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_word</span><span class="hljs-params">(val, mask)</span>:</span>
        bin_val = bin(int(val))[<span class="hljs-number">2</span>:]
        bin_val_padded = <span class="hljs-string">'0'</span> * (len(mask)-len(bin_val)) + bin_val
        <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>.join(a <span class="hljs-keyword">if</span> m == <span class="hljs-string">'X'</span> <span class="hljs-keyword">else</span> m <span class="hljs-keyword">for</span> a, m <span class="hljs-keyword">in</span> zip(bin_val_padded, mask))

    mem = {}
    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:
        <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">'mask'</span>):
            _, mask = line.split(<span class="hljs-string">' = '</span>)
            <span class="hljs-keyword">continue</span>
        addr, val = re.search(<span class="hljs-string">'\[(\d+)\] = (\d+)'</span>, line).groups()
        mem[addr] = get_word(val, mask)
    <span class="hljs-keyword">return</span> sum(int(a, <span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> mem.values())
</code></pre></div>

<div><h3 id="executetheinitializationprogramusinganemulatorforaversion2decoderchipwhatisthesumofallvaluesleftinmemoryafteritcompletes">Execute the initialization program using an emulator for a version 2 decoder chip. What is the sum of all values left in memory after it completes?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_14_b</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''208'''</span>
    <span class="hljs-keyword">import</span> itertools, re

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">address_generator</span><span class="hljs-params">(addr, mask)</span>:</span>
        bin_addr = bin(int(addr))[<span class="hljs-number">2</span>:]
        bin_addr_padded = <span class="hljs-string">'0'</span> * (len(mask)-len(bin_addr)) + bin_addr
        addr_template = <span class="hljs-string">''</span>.join(a <span class="hljs-keyword">if</span> m == <span class="hljs-string">'0'</span> <span class="hljs-keyword">else</span> m <span class="hljs-keyword">for</span> a, m <span class="hljs-keyword">in</span> zip(bin_addr_padded, mask))
        <span class="hljs-keyword">for</span> floating_bits <span class="hljs-keyword">in</span> itertools.product(<span class="hljs-string">'01'</span>, repeat=addr_template.count(<span class="hljs-string">'X'</span>)):
            floating_bits = iter(floating_bits)
            <span class="hljs-keyword">yield</span> <span class="hljs-string">''</span>.join(next(floating_bits) <span class="hljs-keyword">if</span> ch == <span class="hljs-string">'X'</span> <span class="hljs-keyword">else</span> ch <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> addr_template)

    mem = {}
    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:
        <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">'mask'</span>):
            _, mask = line.split(<span class="hljs-string">' = '</span>)
            <span class="hljs-keyword">continue</span>
        addr, val = re.search(<span class="hljs-string">'\[(\d+)\] = (\d+)'</span>, line).groups()
        <span class="hljs-keyword">for</span> address <span class="hljs-keyword">in</span> address_generator(addr, mask):
            mem[address] = val
    <span class="hljs-keyword">return</span> sum(int(a) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> mem.values())
</code></pre></div>

<div><h2 id="day15numbersgame"><a href="#day15numbersgame" name="day15numbersgame">#</a>Day 15: Numbers Game</h2><pre><code class="text language-text">0,3,6
</code></pre></div>

<div><h3 id="givenyourstartingnumberswhatwillbethe2020thnumberspoken">Given your starting numbers, what will be the 2020th number spoken?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_15_a</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''436'''</span>
    *record, last_spoken = [int(a) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> lines[<span class="hljs-number">0</span>].split(<span class="hljs-string">','</span>)]
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(len(record)+<span class="hljs-number">1</span>, <span class="hljs-number">2020</span>):
        delta = list(reversed(record)).index(last_spoken) + <span class="hljs-number">1</span> <span class="hljs-keyword">if</span> last_spoken <span class="hljs-keyword">in</span> record <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>
        record.append(last_spoken)
        last_spoken = delta
    <span class="hljs-keyword">return</span> last_spoken
</code></pre></div>

<div><h3 id="givenyourstartingnumberswhatwillbethe30000000thnumberspoken">Given your starting numbers, what will be the 30000000th number spoken?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_15_b</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''175594'''</span>
    *record, last_spoken = [int(a) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> lines[<span class="hljs-number">0</span>].split(<span class="hljs-string">','</span>)]
    record = {a: record.index(a)+<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> record}
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(record)+<span class="hljs-number">1</span>, <span class="hljs-number">30000000</span>):
        delta = i - record[last_spoken] <span class="hljs-keyword">if</span> last_spoken <span class="hljs-keyword">in</span> record <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>
        record[last_spoken] = i
        last_spoken = delta
    <span class="hljs-keyword">return</span> last_spoken
</code></pre></div>

<div><h2 id="day16tickets"><a href="#day16tickets" name="day16tickets">#</a>Day 16: Tickets</h2><pre><code class="text language-text">class: 1-3 or 5-7
row: 6-11 or 33-44
departure: 13-40 or 45-50

your ticket:
7,1,14

nearby tickets:
7,3,47
40,4,50
55,2,20
38,6,12
</code></pre></div>

<div><h3 id="considerthevalidityofthenearbyticketsyouscannedwhatisyourticketscanningerrorrate">Consider the validity of the nearby tickets you scanned. What is your ticket scanning error rate?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_16_a</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''71'''</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_valid_ranges</span><span class="hljs-params">(field)</span>:</span>
        <span class="hljs-keyword">for</span> range_ <span class="hljs-keyword">in</span> field.split(<span class="hljs-string">': '</span>)[<span class="hljs-number">1</span>].split(<span class="hljs-string">' or '</span>):
            start, stop = [int(a) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> range_.split(<span class="hljs-string">'-'</span>)]
            <span class="hljs-keyword">yield</span> range(start, stop+<span class="hljs-number">1</span>)

    fields, _, nerby_tickets = [a.split(<span class="hljs-string">'\r'</span>) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> <span class="hljs-string">'\r'</span>.join(lines).split(<span class="hljs-string">'\r\r'</span>)]
    valid_ranges = [range_ <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> fields <span class="hljs-keyword">for</span> range_ <span class="hljs-keyword">in</span> get_valid_ranges(f)]
    is_valid = <span class="hljs-keyword">lambda</span> value: any(value <span class="hljs-keyword">in</span> a <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> valid_ranges)
    values = [int(a) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> <span class="hljs-string">','</span>.join(nerby_tickets[<span class="hljs-number">1</span>:]).split(<span class="hljs-string">','</span>)]
    <span class="hljs-keyword">return</span> sum(a <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> values <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> is_valid(a))
</code></pre></div>

<div><h3 id="onceyouworkoutwhichfieldiswhichlookforthesixfieldsonyourticketthatstartwiththeworddeparturewhatdoyougetifyoumultiplythosesixvaluestogether">Once you work out which field is which, look for the six fields on your ticket that start with the word departure. What do you get if you multiply those six values together?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_16_b</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''14'''</span>
    <span class="hljs-keyword">import</span> functools, operator <span class="hljs-keyword">as</span> op, re

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>
        fields, your_ticket, nerby_tickets = [a.split(<span class="hljs-string">'\r'</span>) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span>
                                                  <span class="hljs-string">'\r'</span>.join(lines).split(<span class="hljs-string">'\r\r'</span>)]
        valid_tickets = get_valid_tickets(fields, nerby_tickets[<span class="hljs-number">1</span>:] + your_ticket[<span class="hljs-number">1</span>:])
        field_ranges = get_fields_dict(fields)
        out = {i: set(field_ranges.keys()) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(valid_tickets[<span class="hljs-number">0</span>]))}
        purge_solutions(out, valid_tickets, field_ranges)
        <span class="hljs-keyword">while</span> any(len(fields) != <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> fields <span class="hljs-keyword">in</span> out.values()):
            remove_solved_fields(out)
        your_ticket_vals = [int(a) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> your_ticket[<span class="hljs-number">1</span>].split(<span class="hljs-string">','</span>)]
        indices = [i <span class="hljs-keyword">for</span> i, fields <span class="hljs-keyword">in</span> out.items() <span class="hljs-keyword">if</span> <span class="hljs-string">'departure'</span> <span class="hljs-keyword">in</span> next(iter(fields))]
        <span class="hljs-keyword">return</span> functools.reduce(op.mul, (your_ticket_vals[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> indices))

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_valid_tickets</span><span class="hljs-params">(fields, tickets)</span>:</span>
        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_valid_ranges</span><span class="hljs-params">(field)</span>:</span>
            <span class="hljs-keyword">for</span> range_ <span class="hljs-keyword">in</span> field.split(<span class="hljs-string">': '</span>)[<span class="hljs-number">1</span>].split(<span class="hljs-string">' or '</span>):
                start, stop = [int(a) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> range_.split(<span class="hljs-string">'-'</span>)]
                <span class="hljs-keyword">yield</span> range(start, stop+<span class="hljs-number">1</span>)
        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_ticket_valid</span><span class="hljs-params">(ticket)</span>:</span>
            values = [int(value) <span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> ticket.split(<span class="hljs-string">','</span>)]
            <span class="hljs-keyword">return</span> all(any(value <span class="hljs-keyword">in</span> range_ <span class="hljs-keyword">for</span> range_ <span class="hljs-keyword">in</span> valid_ranges) <span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> values)
        valid_ranges = [range_ <span class="hljs-keyword">for</span> field <span class="hljs-keyword">in</span> fields <span class="hljs-keyword">for</span> range_ <span class="hljs-keyword">in</span> get_valid_ranges(field)]
        <span class="hljs-keyword">return</span> [[int(a) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> t.split(<span class="hljs-string">','</span>)] <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> tickets <span class="hljs-keyword">if</span> is_ticket_valid(t)]

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_fields_dict</span><span class="hljs-params">(fields)</span>:</span>
        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_item</span><span class="hljs-params">(field)</span>:</span>
            name, start_1, stop_1, start_2, stop_2 = \
                re.match(<span class="hljs-string">'^(.*): (\d+)-(\d+) or (\d+)-(\d+)'</span>, field).groups()
            <span class="hljs-keyword">return</span> name, [range(int(start_1), int(stop_1)+<span class="hljs-number">1</span>),
                          range(int(start_2), int(stop_2)+<span class="hljs-number">1</span>)]
        <span class="hljs-keyword">return</span> dict(get_item(field) <span class="hljs-keyword">for</span> field <span class="hljs-keyword">in</span> fields)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">purge_solutions</span><span class="hljs-params">(out, valid_tickets, field_ranges)</span>:</span>
        get_column = <span class="hljs-keyword">lambda</span> i: [a[i] <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> valid_tickets]
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(valid_tickets[<span class="hljs-number">0</span>])):
            <span class="hljs-keyword">for</span> val <span class="hljs-keyword">in</span> get_column(i):
                <span class="hljs-keyword">for</span> field_name, ranges <span class="hljs-keyword">in</span> field_ranges.items():
                    <span class="hljs-keyword">if</span> all(val <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> range_ <span class="hljs-keyword">for</span> range_ <span class="hljs-keyword">in</span> ranges):
                        out[i] -= {field_name}

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">remove_solved_fields</span><span class="hljs-params">(out)</span>:</span>
        solved_fields = {next(iter(fields)) <span class="hljs-keyword">for</span> fields <span class="hljs-keyword">in</span> out.values() <span class="hljs-keyword">if</span> len(fields) == <span class="hljs-number">1</span>}
        <span class="hljs-keyword">for</span> possible_fields <span class="hljs-keyword">in</span> out.values():
            <span class="hljs-keyword">if</span> len(possible_fields) != <span class="hljs-number">1</span>:
                possible_fields -= solved_fields

    <span class="hljs-keyword">return</span> main()
</code></pre></div>

<div><h2 id="day17cubes"><a href="#day17cubes" name="day17cubes">#</a>Day 17: Cubes</h2><pre><code class="text language-text">.#.
..#
###
</code></pre></div>

<div><h3 id="startingwithyourgiveninitialconfigurationsimulatesixcycleshowmanycubesareleftintheactivestateafterthesixthcycle">Starting with your given initial configuration, simulate six cycles. How many cubes are left in the active state after the sixth cycle?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_17_a</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''112'''</span>
    <span class="hljs-keyword">import</span> collections, itertools
    P = collections.namedtuple(<span class="hljs-string">'P'</span>, <span class="hljs-string">'x y z'</span>)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_neighbours</span><span class="hljs-params">(p)</span>:</span>
        DELTAS = set(itertools.product([<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>], repeat=<span class="hljs-number">3</span>)) - {(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)}
        <span class="hljs-keyword">return</span> {P(p.x + dx, p.y + dy, p.z + dz) <span class="hljs-keyword">for</span> dx, dy, dz <span class="hljs-keyword">in</span> DELTAS}

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">should_be_active</span><span class="hljs-params">(p)</span>:</span>
        n_active_neighbours = len(get_neighbours(p) &amp; cubes)
        <span class="hljs-keyword">return</span> (p <span class="hljs-keyword">in</span> cubes <span class="hljs-keyword">and</span> <span class="hljs-number">2</span> &lt;= n_active_neighbours &lt;= <span class="hljs-number">3</span>) <span class="hljs-keyword">or</span> \
               (p <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> cubes <span class="hljs-keyword">and</span> n_active_neighbours == <span class="hljs-number">3</span>)

    cubes = {P(x, y, <span class="hljs-number">0</span>) <span class="hljs-keyword">for</span> y, line <span class="hljs-keyword">in</span> enumerate(lines)
                            <span class="hljs-keyword">for</span> x, ch <span class="hljs-keyword">in</span> enumerate(line) <span class="hljs-keyword">if</span> ch == <span class="hljs-string">'#'</span>}
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(<span class="hljs-number">6</span>):
        candidates = {p <span class="hljs-keyword">for</span> cube <span class="hljs-keyword">in</span> cubes <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> get_neighbours(cube)}
        cubes = {p <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> candidates <span class="hljs-keyword">if</span> should_be_active(p)}
    <span class="hljs-keyword">return</span> len(cubes)
</code></pre></div>

<div><h3 id="startingwithyourgiveninitialconfigurationsimulatesixcyclesina4dimensionalspacehowmanycubesareleftintheactivestateafterthesixthcycle">Starting with your given initial configuration, simulate six cycles in a 4-dimensional space. How many cubes are left in the active state after the sixth cycle?</h3><pre><code class="python language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">problem_17_b</span><span class="hljs-params">(lines)</span>:</span>
    <span class="hljs-string">'''848'''</span>
    <span class="hljs-keyword">import</span> collections, itertools
    P = collections.namedtuple(<span class="hljs-string">'P'</span>, <span class="hljs-string">'x y z w'</span>)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_neighbours</span><span class="hljs-params">(p)</span>:</span>
        DELTAS = set(itertools.product([<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>], repeat=<span class="hljs-number">4</span>)) - {(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)}
        <span class="hljs-keyword">return</span> {P(p.x+dx, p.y+dy, p.z+dz, p.w+dw) <span class="hljs-keyword">for</span> dx, dy, dz, dw <span class="hljs-keyword">in</span> DELTAS}

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">should_be_active</span><span class="hljs-params">(p)</span>:</span>
        n_active_neighbours = len(get_neighbours(p) &amp; cubes)
        <span class="hljs-keyword">return</span> (p <span class="hljs-keyword">in</span> cubes <span class="hljs-keyword">and</span> <span class="hljs-number">2</span> &lt;= n_active_neighbours &lt;= <span class="hljs-number">3</span>) <span class="hljs-keyword">or</span> \
               (p <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> cubes <span class="hljs-keyword">and</span> n_active_neighbours == <span class="hljs-number">3</span>)

    cubes = {P(x, y, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>) <span class="hljs-keyword">for</span> y, line <span class="hljs-keyword">in</span> enumerate(lines)
                               <span class="hljs-keyword">for</span> x, ch <span class="hljs-keyword">in</span> enumerate(line) <span class="hljs-keyword">if</span> ch == <span class="hljs-string">'#'</span>}
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(<span class="hljs-number">6</span>):
        candidates = {p <span class="hljs-keyword">for</span> cube <span class="hljs-keyword">in</span> cubes <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> get_neighbours(cube)}
        cubes = {p <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> candidates <span class="hljs-keyword">if</span> should_be_active(p)}
    <span class="hljs-keyword">return</span> len(cubes)
</code></pre></div>
 

  <footer>
    <aside>December 12, 2020</aside>
    <a href="../" rel="author">Jure Šorn</a>
  </footer>

  <script src="web/jquery-3.4.0.min.js"></script>
  <script src="web/script_2.js"></script>
</body>
</html>
